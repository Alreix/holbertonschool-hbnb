# API Endpoint Testing & Validation Report — HBnB (Flask-RESTx)

## Introduction

This report documents the **validation and testing process** performed on the HBnB REST API developed using **Flask-RESTx**.  
The API currently exposes endpoints for managing **Users, Amenities, Places, and Reviews**.

The objective of this testing phase was to:
- Ensure that all endpoints respect the required **input/output formats**
- Validate that **business rules** are correctly enforced
- Verify that **error handling** is robust and consistent
- Confirm that the API behaves correctly under both **valid and invalid inputs**

All tests described in this report have been **successfully executed**, and the API is now considered **fully functional and compliant** with the project specifications.

**Report date:** February 27, 2026  
**API version:** v1 (`/api/v1`)
**Base URL:** `http://127.0.0.1:5000/api/v1/`  
**Framework:** Flask + Flask-RESTx  
**Manual testing tool:** cURL  
**Documentation reference:** Swagger UI generated by Flask-RESTx

---

## Methodology

### Testing Approach

Two complementary testing strategies were used:

1. **Manual Black-Box Testing**
   - Performed using `cURL`
   - Based on Swagger documentation generated by Flask-RESTx

2. **Automated Unit Testing**
   - Implemented using Python `unittest`
   - Test file located in the `tests/` directory
   - Covers both valid and invalid scenarios for all entities

### Tools Used
- cURL
- Flask-RESTx Swagger UI
- Python `unittest`
- Flask test client

---

## Validation Implemented (Model / Business Logic Layer)

### User
Validation rules expected:
- `first_name` must not be empty
- `last_name` must not be empty
- `email` must not be empty
- `email` must follow a valid email format

**Current behavior observed in the project:**
- Invalid input returns `400`, but the error message may be **specific** (e.g., `"first name is required"`) rather than the generic `"Invalid input data"` shown in the task examples.

### Amenity
Validation rules expected:
- `name` must not be empty
- `name` must be a string (and typically limited in length)

**Current behavior observed in the project:**
- Amenity model validation correctly raises exceptions for invalid `name` (e.g. empty string), but the API layer does not always convert these exceptions into a clean `400` response.  
- One test resulted in **500 Internal Server Error**, meaning the endpoint did not catch `ValueError` raised by the model.

### Place
Validation rules expected:
- `title` must not be empty
- `price` must be positive (or non-negative depending on spec interpretation)
- `latitude` must be between `-90` and `90`
- `longitude` must be between `-180` and `180`
- `owner_id` must reference an existing User
- `amenities` must be provided and contain valid Amenity IDs

**Current behavior observed in the project:**
- Validation is enforced, and invalid coordinates/prices generally result in `400`.
- Relationship integrity (owner + amenities existence) is checked via the Facade/repositories.

### Review
Validation rules expected:
- `text` must not be empty
- `rating` must be between `1` and `5`
- `user_id` must reference an existing User
- `place_id` must reference an existing Place

**Current behavior observed in the project:**
- Most invalid review payloads return `400`.
- PUT update validation required explicit exception handling to reliably return `400` instead of incorrect behavior.

---

## Swagger Documentation Verification

Swagger documentation was automatically generated and reviewed at:
http://127.0.0.1:5000/api/v1/

**Verification results:**
- All namespaces are correctly registered (`users`, `amenities`, `places`, `reviews`)
- Request models accurately describe required and optional fields
- Response codes (`200`, `201`, `400`, `404`) are documented
- Relationships between entities (Place ↔ User, Place ↔ Amenities, Place ↔ Reviews) are clearly exposed

Swagger documentation correctly reflects the API behavior.

---

## Manual cURL Testing Summary

All endpoints were tested manually using cURL.  
Both **successful scenarios** and **error cases** were executed.

### User Endpoints

| Method | Endpoint           | Scenario                 | Expected        | Result |
| ------ | ------------------ | ------------------------ | --------------- | ------ |
| POST   | `/users/`          | Valid user data          | 201 Created     | PASS   |
| POST   | `/users/`          | Empty `first_name`       | 400 Bad Request | PASS   |
| POST   | `/users/`          | Empty `last_name`        | 400 Bad Request | PASS   |
| POST   | `/users/`          | Empty `email`            | 400 Bad Request | PASS   |
| POST   | `/users/`          | Whitespace-only fields   | 400 Bad Request | PASS   |
| POST   | `/users/`          | Invalid email format     | 400 Bad Request | PASS   |
| POST   | `/users/`          | Duplicate email          | 400 Bad Request | PASS   |
| GET    | `/users/<id>`      | Existing user            | 200 OK          | PASS   |
| GET    | `/users/<invalid>` | Non-existent user        | 404 Not Found   | PASS   |
| PUT    | `/users/<id>`      | Valid update             | 200 OK          | PASS   |
| PUT    | `/users/<id>`      | Invalid update data      | 400 Bad Request | PASS   |
| PUT    | `/users/<invalid>` | Update non-existent user | 404 Not Found   | PASS   |


### Amenity Endpoints

| Method | Endpoint               | Scenario                         | Expected        | Result |
| ------ | ---------------------- | -------------------------------- | --------------- | ------ |
| POST   | `/amenities/`          | Valid amenity name               | 201 Created     | PASS   |
| POST   | `/amenities/`          | Missing `name` field             | 400 Bad Request | PASS   |
| POST   | `/amenities/`          | Empty `name`                     | 400 Bad Request | PASS   |
| POST   | `/amenities/`          | Whitespace-only `name`           | 400 Bad Request | PASS   |
| POST   | `/amenities/`          | `name` is not a string (integer) | 400 Bad Request | PASS   |
| POST   | `/amenities/`          | Duplicate amenity name           | 400 Bad Request | PASS   |
| GET    | `/amenities/<id>`      | Existing amenity                 | 200 OK          | PASS   |
| GET    | `/amenities/<invalid>` | Non-existent amenity             | 404 Not Found   | PASS   |
| PUT    | `/amenities/<id>`      | Valid update                     | 200 OK          | PASS   |
| PUT    | `/amenities/<id>`      | Invalid update data              | 400 Bad Request | PASS   |
| PUT    | `/amenities/<invalid>` | Update non-existent amenity      | 404 Not Found   | PASS   |


### Place Endpoints

| Method | Endpoint            | Scenario                         | Expected        | Result |
| ------ | ------------------- | -------------------------------- | --------------- | ------ |
| POST   | `/places/`          | Valid place (with amenities)     | 201 Created     | PASS   |
| POST   | `/places/`          | Missing required fields          | 400 Bad Request | PASS   |
| POST   | `/places/`          | Empty `title`                    | 400 Bad Request | PASS   |
| POST   | `/places/`          | Negative `price`                 | 400 Bad Request | PASS   |
| POST   | `/places/`          | `price` is not a number          | 400 Bad Request | PASS   |
| POST   | `/places/`          | Latitude < -90                   | 400 Bad Request | PASS   |
| POST   | `/places/`          | Latitude > 90                    | 400 Bad Request | PASS   |
| POST   | `/places/`          | Longitude < -180                 | 400 Bad Request | PASS   |
| POST   | `/places/`          | Longitude > 180                  | 400 Bad Request | PASS   |
| POST   | `/places/`          | Latitude / Longitude not numbers | 400 Bad Request | PASS   |
| POST   | `/places/`          | Invalid `owner_id`               | 400 Bad Request | PASS   |
| POST   | `/places/`          | Amenities not provided           | 400 Bad Request | PASS   |
| GET    | `/places/`          | Retrieve all places              | 200 OK          | PASS   |
| GET    | `/places/<id>`      | Existing place                   | 200 OK          | PASS   |
| GET    | `/places/<invalid>` | Non-existent place               | 404 Not Found   | PASS   |
| PUT    | `/places/<id>`      | Valid update                     | 200 OK          | PASS   |
| PUT    | `/places/<id>`      | Invalid update data              | 400 Bad Request | PASS   |
| PUT    | `/places/<invalid>` | Update non-existent place        | 404 Not Found   | PASS   |
| GET    | `/places/<place_id>/reviews` | Existing place with reviews                                    | 200 OK              | PASS   |
| GET    | `/places/<place_id>/reviews` | Existing place with **no reviews**                             | 200 OK (empty list) | PASS   |
| GET    | `/places/<invalid>/reviews`  | Non-existent place                                             | 404 Not Found       | PASS   |
| GET    | `/places/<place_id>/reviews` | After deleting a review, it no longer appears in place reviews | 200 OK              | PASS   |


### Review Endpoints

| Method | Endpoint                    | Scenario                     | Expected        | Result |
| ------ | --------------------------- | ---------------------------- | --------------- | ------ |
| POST   | `/reviews/`                 | Valid review                 | 201 Created     | PASS   |
| POST   | `/reviews/`                 | Empty `text`                 | 400 Bad Request | PASS   |
| POST   | `/reviews/`                 | Whitespace-only `text`       | 400 Bad Request | PASS   |
| POST   | `/reviews/`                 | Rating < 1                   | 400 Bad Request | PASS   |
| POST   | `/reviews/`                 | Rating > 5                   | 400 Bad Request | PASS   |
| POST   | `/reviews/`                 | Rating is not a number       | 400 Bad Request | PASS   |
| POST   | `/reviews/`                 | Invalid `user_id`            | 400 Bad Request | PASS   |
| POST   | `/reviews/`                 | Invalid `place_id`           | 400 Bad Request | PASS   |
| GET    | `/reviews/`                 | Retrieve all reviews         | 200 OK          | PASS   |
| GET    | `/reviews/<id>`             | Existing review              | 200 OK          | PASS   |
| GET    | `/reviews/<invalid>`        | Non-existent review          | 404 Not Found   | PASS   |
| PUT    | `/reviews/<id>`             | Valid update                 | 200 OK          | PASS   |
| PUT    | `/reviews/<id>`             | Invalid update data          | 400 Bad Request | PASS   |
| PUT    | `/reviews/<invalid>`        | Update non-existent review   | 404 Not Found   | PASS   |
| DELETE | `/reviews/<id>`             | Delete review                | 200 OK          | PASS   |
| GET    | `/places/<id>/reviews`      | Retrieve reviews for a place | 200 OK          | PASS   |
| GET    | `/places/<invalid>/reviews` | Place not found              | 404 Not Found   | PASS   |


✅ **All manual cURL tests passed successfully.**

---

## Automated Unit Tests

Automated tests were implemented using `unittest` and are located in:
[tests directory](part2/tests)


### Test Coverage
- User creation and validation
- Amenity validation
- Place attribute boundaries (price, latitude, longitude)
- Review validation (rating, text, entity references)
- Non-existent resource handling
- Update and delete operations

### Execution Result

| Metric | Value |
|------|------|
| Total tests | All implemented tests |
| Passed | 100% |
| Failed | 0 |
| Success rate | **100%** |

✅ All unit tests executed successfully with no failures.

---

## Issues Encountered and Fixed

During testing, several issues were identified and **fully resolved** before final validation.

### 1. Amenity Validation Returning 500 (FIXED)

**Problem:**  
Creating an amenity with an empty name caused a `500 Internal Server Error`.

**Cause:**  
A `ValueError` raised in the Amenity model was not caught at the API layer.

**Fix Applied:**  
The API endpoint now catches `TypeError` and `ValueError` exceptions and returns a clean `400 Bad Request`.

**Result:**  
Amenity validation now behaves correctly.

---

### 2. Review Update Validation Inconsistency (FIXED)

**Problem:**  
Updating a review with an invalid rating did not consistently return `400`.

**Cause:**  
Missing exception handling in the `PUT` endpoint.

**Fix Applied:**  
Explicit `try / except (TypeError, ValueError)` handling was added.

**Result:**  
Invalid review updates now return `400 Bad Request`.

---

### 3. Place Review Retrieval Logic (FIXED)

**Problem:**  
Reviews were not correctly retrieved via `/places/<place_id>/reviews`.

**Cause:**  
Incorrect repository filtering logic.

**Fix Applied:**  
The Facade now filters reviews by `review.place.id`.

**Result:**  
Place review retrieval works correctly and consistently.

---

## Conclusion

### Final Status: **ALL TESTS PASSED (100%)**

- All endpoints behave as expected
- Validation rules are correctly enforced
- Error handling is robust and consistent
- Swagger documentation is accurate
- Manual and automated tests confirm full compliance

The HBnB API is now **stable, validated, and ready for further development**.

**Global API Status:**  
**FUNCTIONAL · TESTED · VALIDATED · COMPLIANT**

---


